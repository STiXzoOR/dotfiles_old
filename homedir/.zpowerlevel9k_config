#
# POWERLEVEL9K
#
# for code ({000..255}) print -P -- "$code: %F{$code} This is how your text would look like%f"

#####################################################################################
# Functions
#####################################################################################

p9k_color_codes(){
	
	local code
	for code ({000..255}) print -P -- "$code: %F{$code} This is how your text would look like%f"

}

zsh_wifi_signal(){
	
	local signal=$(airport -I | grep agrCtlRSSI | awk '{print $2}' | sed 's/-//g')
  	local noise=$(airport -I | grep agrCtlNoise | awk '{print $2}' | sed 's/-//g')
  	local SNR=$(bc <<<"scale=2; $signal / $noise")

	local net=$(curl -D- -o /dev/null -s http://www.google.com | grep HTTP/1.1 | awk '{print $2}')
	local symbol="\uf197"

	# Excellent Signal (5 bars)
	if [[ ! -z "${signal// }" ]] && [[ $SNR -gt .40 ]];then
	   	symbol="\uf1eb"
	fi

	# Good Signal (3-4 bars)
	if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .40 ]] && [[ $SNR -gt .25 ]];then 
	    symbol="\uf6ab"
	fi

	# Very Low Signal (1 bar)
	if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .15 ]] && [[ $SNR -gt .10 ]];then 
	    symbol="\uf6aa"
	fi

	# No Signal - No Internet
	if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .10 ]];then 
		symbol="\uf6ac"
	fi

	if [[ -z "${signal// }" ]] && [[ "$net" -ne 200 ]];then 
	    symbol="\uf204"
	fi

	# Ethernet Connection (no wifi, hardline)
	if [[ -z "${signal// }" ]] && [[ "$net" -eq 200 ]];then
		symbol="\uf197"
	fi

	echo -n "$symbol "

}

prompt_chistory() {
	
	HISTORY_ICON=$'\uF7D9'
  	"$1_prompt_segment" "$0" "$2" "grey50" "$DEFAULT_COLOR" "%h $HISTORY_ICON"
}

set_preset() {
	
	if [ "$1" = "Dracula" ]; then
		echo -e "\033]1337;SetColors=preset=Dracula\a"
 	elif [ "$1" = "Solarized" ]; then
		echo -e "\033]1337;SetColors=preset=Solarized_Dark_Patched\a"
	fi
}

#####################################################################################
# Settings
#####################################################################################

# PALLETE
DEFAULT_FOREGROUND=117 #075
DEFAULT_BACKGROUND=236
GIT_CLEAN_FOREGROUND=071 #041
GIT_MODIFIED_FOREGROUND=185
GIT_UNTRACKED_FOREGROUND=141

# PROMT
#POWERLEVEL9K_MODE="nerdfont-complete"
POWERLEVEL9K_MODE="awesome-fontconfig"
POWERLEVEL9K_PROMPT_ON_NEWLINE=true
POWERLEVEL9K_PROMPT_ADD_NEWLINE=true
POWERLEVEL9K_MULTILINE_FIRST_PROMPT_PREFIX="╭"
POWERLEVEL9K_MULTILINE_LAST_PROMPT_PREFIX="╰\uF460 "

# LEFT PROMPT
POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(os_icon root_indicator dir_writable dir vcs)
POWERLEVEL9K_LEFT_SEGMENT_SEPARATOR="\uE0B0"
POWERLEVEL9K_LEFT_SUBSEGMENT_SEPARATOR="%F{$(( $DEFAULT_BACKGROUND ))}\uE0B1%f"

# RIGHT PROMPT
POWERLEVEL9K_RPROMPT_ON_NEWLINE=false
POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(history time status)
POWERLEVEL9K_RIGHT_SEGMENT_SEPARATOR="\uE0B2"
POWERLEVEL9K_RIGHT_SUBSEGMENT_SEPARATOR="%F{$(( $DEFAULT_BACKGROUND ))}\uE0B3%f"

# OS ICON
POWERLEVEL9K_OS_ICON_FOREGROUND="white"
POWERLEVEL9K_OS_ICON_BACKGROUND="$DEFAULT_BACKGROUND"

# ROOT
POWERLEVEL9K_ROOT_INDICATOR_FOREGROUND="magenta"
POWERLEVEL9K_ROOT_INDICATOR_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_ROOT_ICON=$'\uF198'

# DIR
POWERLEVEL9K_SHORTEN_DIR_LENGTH=7
POWERLEVEL9K_DIR_OMIT_FIRST_CHARACTER=false
POWERLEVEL9K_DIR_HOME_BACKGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_DIR_HOME_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_HOME_SUBFOLDER_BACKGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_DIR_HOME_SUBFOLDER_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_DEFAULT_BACKGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_DIR_DEFAULT_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_WRITABLE_FORBIDDEN_BACKGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_DIR_WRITABLE_FORBIDDEN_FOREGROUND="$DEFAULT_BACKGROUND"

# GITHUB
POWERLEVEL9K_VCS_CLEAN_BACKGROUND="$GIT_CLEAN_FOREGROUND"
POWERLEVEL9K_VCS_CLEAN_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_VCS_MODIFIED_BACKGROUND="$GIT_MODIFIED_FOREGROUND"
POWERLEVEL9K_VCS_MODIFIED_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_VCS_UNTRACKED_BACKGROUND="$GIT_UNTRACKED_FOREGROUND"
POWERLEVEL9K_VCS_UNTRACKED_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_VCS_STAGED_ICON="\u00b1"
POWERLEVEL9K_VCS_UNTRACKED_ICON="\u25CF"
POWERLEVEL9K_VCS_UNSTAGED_ICON="\u00b1"
POWERLEVEL9K_VCS_INCOMING_CHANGES_ICON="\u2193"
POWERLEVEL9K_VCS_OUTGOING_CHANGES_ICON="\u2191"
#POWERLEVEL9K_VCS_GIT_GITHUB_ICON=""
POWERLEVEL9K_VCS_GIT_BITBUCKET_ICON=""
POWERLEVEL9K_VCS_GIT_GITLAB_ICON=""
POWERLEVEL9K_VCS_GIT_ICON=""

# STATUS
POWERLEVEL9K_STATUS_VERBOSE=false
POWERLEVEL9K_STATUS_CROSS=true
#POWERLEVEL9K_STATUS_OK_FOREGROUND="022"
POWERLEVEL9K_STATUS_OK_BACKGROUND="white"
#POWERLEVEL9K_STATUS_ERROR_FOREGROUND="088"
POWERLEVEL9K_STATUS_ERROR_BACKGROUND="white"

# HISTORY
POWERLEVEL9K_HISTORY_FOREGROUND="$DEFAULT_BACKGROUND"

# CHISTORY
POWERLEVEL9K_CHISTORY_FOREGROUND="$DEFAULT_BACKGROUND"

# NODE
POWERLEVEL9K_NODE_VERSION_FOREGROUND="$DEFAULT_BACKGROUND"

# TIME
POWERLEVEL9K_TIME_FORMAT="%D{%T}"
POWERLEVEL9K_TIME_FOREGROUND="$DEFAULT_BACKGROUND"
#POWERLEVEL9K_TIME_BACKGROUND="$DEFAULT_BACKGROUND"

# USER
POWERLEVEL9K_USER_ICON="\uF415"
POWERLEVEL9K_USER_DEFAULT_FOREGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_USER_DEFAULT_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_USER_ROOT_FOREGROUND="$DEFAULT_FOREGROUND"
POWERLEVEL9K_USER_ROOT_BACKGROUND="$DEFAULT_BACKGROUND"

# SSH
POWERLEVEL9K_SSH_FOREGROUND="yellow"
POWERLEVEL9K_SSH_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_SSH_ICON="\uF489"

# BATTERY
POWERLEVEL9K_BATTERY_LEVEL_BACKGROUND_COLOR="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_CHARGING_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_CHARGED_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_DISCONNECTED_BACKGROUND="$DEFAULT_BACKGROUND"

# WIFI
POWERLEVEL9K_CUSTOM_WIFI_SIGNAL="zsh_wifi_signal"
POWERLEVEL9K_CUSTOM_WIFI_SIGNAL_FOREGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_CUSTOM_WIFI_SIGNAL_BACKGROUND="grey58"